#include <Windows.h>
#include <stdio.h>
#include <TlHelp32.h>
#include <tchar.h>


// Get PID by name form cmd arguments
// Using CreateToolhelp32Snapshot/Process32First/Process32Next
// We take a snapshout of our system and iterate over the processes to find our's

int main(int argc, char* argv[]) {
	
	if (argc < 2) {
		_tprintf(TEXT("Please enter process name\r\n"));
		return 1;
	}
	
	HANDLE handleSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, NULL);

	if (handleSnapshot == INVALID_HANDLE_VALUE) {
		_tprintf(TEXT("Can't create a snapshot of the current system\r\n"));
		return 1;
	}

	PROCESSENTRY32 processEntry;
	processEntry.dwSize = sizeof(processEntry);

	if (Process32First(handleSnapshot, &processEntry)) {
		do {
			if (processEntry.szExeFile == argv[1]) {
				int pid = processEntry.th32ProcessID;
				_tprintf(TEXT("Here is Your PID: %d"), pid);
				return 0;
			}
		} while (Process32Next(handleSnapshot, &processEntry));
	}
	_tprintf(TEXT("Process wasn't found..\r\n"));
	return 1;
}
